import pygame
import random

# Pygame-ni ishga tushirish
pygame.init()

# O'yin oynasining o'lchamlarini belgilash
winHeight = 480
winWidth = 700
win = pygame.display.set_mode((winWidth, winHeight))

BLACK = (0, 0, 0)
WHITE = (255, 255, 255)

RED = (255, 0, 0)
GREEN = (0, 255, 0)
BLUE = (0, 0, 255)
LIGHT_BLUE = (102, 255, 255)

# Shriftlarni belgilash
btn_font = pygame.font.SysFont("arial", 20)

guess_font = pygame.font.SysFont("monospace", 24)
lost_font = pygame.font.SysFont('arial', 45)

# Global o'zgaruvchilar
word = ''
buttons = []
guessed = []
limbs = 0
hangmanPics = [
    pygame.image.load('hangman0.png'),
    pygame.image.load('hangman1.png'),
    pygame.image.load('hangman2.png'),
    pygame.image.load('hangman3.png'),
    pygame.image.load('hangman4.png'),
    pygame.image.load('hangman5.png'),
    pygame.image.load('hangman6.png')
]
def redraw_game_window():
global guessed
    global limbs
    win.fill(GREEN)  
    for button in buttons:
        if button[4]:  # Agar tugma ko'rsatilayotgan bo'lsa
            pygame.draw.circle(win, BLACK, (button[1], button[2]), button[3])
            pygame.draw.circle(win, button[0], (button[1], button[2]), button[3] - 2)
            label = btn_font.render(chr(button[5]), 1, BLACK)
            win.blit(label, (button[1] - label.get_width() / 2, button[2] - label.get_height() / 2))
            
    spaced = spacedOut(word, guessed)        
    label1 = guess_font.render(spaced, 1, BLACK)
    rect = label1.get_rect()
    win.blit(label1, (winWidth / 2 - rect[2] / 2, 400))

    # Hangman tasvirini chizish
    pic = hangmanPics[limbs]
    win.blit(pic, (winWidth / 2 - pic.get_width() / 2 + 20, 150))
    pygame.display.update()
def randomWord():
    with open('words.txt') as file:
        words = file.readlines()
        return words[random.randrange(0, len(words))].strip()
def hang(guess):
    global word
    return guess.lower() not in word.lower()
def spacedOut(word, guessed=[]):
    spacedWord = ''
    for x in range(len(word)):
        if word[x] != ' ':
            spacedWord += '_ '
            if word[x].upper() in guessed:
                spacedWord = spacedWord[:-2] + word[x].upper() + ' '
        elif word[x] == ' ':
            spacedWord += ' '
    return spacedWord
def buttonHit(x, y):
    for button in buttons:
        if x < button[1] + 20 and x > button[1] - 20:
            if y < button[2] + 20 and y > button[2] - 20:
                return button[5]
    return None 
def end(winner=False):
    global limbs
    winTxt = 'WINNER! Press any key to play again...'
    lostTxt = 'You Lost! Press any key to play again...'
    redraw_game_window()
    pygame.time.delay(1000)
    win.fill(GREEN)


    # Yakuniy xabarni ko'rsatish
    label = lost_font.render(winTxt if winner else lostTxt, 1, BLACK)
    wordTxt = lost_font.render(word.upper(), 1, BLACK)
    wordWas = lost_font.render('The phrase was: ', 1, BLACK)

    win.blit(wordWas, (winWidth / 2 - wordWas.get_width() / 2, 245))
    win.blit(wordTxt, (winWidth / 2 - wordTxt.get_width() / 2, 295))
    win.blit(label, (winWidth / 2 - label.get_width() / 2, 140))
    pygame.display.update()
    # O'yin qayta boshlanishini kutish
    waiting = True
    while waiting:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
            if event.type == pygame.KEYDOWN:
                waiting = False
    reset()
def reset():
    global limbs, guessed, buttons, word
    limbs = 0
    guessed = []
    word = randomWord()
    # Tugmalarni qayta tiklash
    for button in buttons:
        button[4] = True
# Harf tugmalarini sozlash
increase = round(winWidth / 13)
for i in range(26):
    x = 25 + (increase * (i % 13))
    y = 40 + (increase * (i // 13))
    buttons.append([LIGHT_BLUE, x, y, 20, True, 65 + i])
# O'yin uchun tasodifiy so'zni olish
word = randomWord()
inPlay = True
    